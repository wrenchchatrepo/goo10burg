# Eraser.io API

## From Prompt (AI diagram)

### Endpoint

Using get_looker.py as an example, I will pass the full contents of they python script to the Eraser.io API endpoint `https://app.eraser.io/api/render/prompt`, the only required param is `text`, the other params we can leave empty

### $ python -m pip install requests

```
import requests
url = "https://app.eraser.io/api/render/prompt"
payload = { "text": "# GET Looker  ## Plan  ###  Authenticate with Looker API: Use your Looker client ID and secret to get an access token. ###  Read the API endpoints from the extracted files. ###  Fetch the data: Make API requests to fetch data from each endpoint. ###  Save the data: Write the fetched data as JSON files to your specified directory.  ## Steps:  ###  Authentication: Replace your_client_id, your_client_secret, and your-looker-instance.com with your actual credentials. ###  Endpoints: You can extract the endpoints from the Markdown files and add them to the endpoints list in the script. ###  Run the script: This will fetch data from each endpoint and save it to the specified directory as JSON files.  ## Instructions:  ### 1. Create an .env file with LOOKER_CLIENT_ID=x0x0x0x0x0x0x0x0x0x LOOKER_CLIENT_SECRET=0x0x0x0x0x0x0x0x0x0 LOOKER_INSTANCE=https://company.looker.com ### 2. This script includes all the relevant Looker API endpoints from your extracted files. ### 3. Replace the placeholders with your actual Looker instance URL, which Iâ€™ve already done with https://company.looker.com. ### 4. Run the script to fetch all the Looker objects and save the results in the /Users/dev/looker_objects directory. ## Script Template  import os import requests import json from dotenv import load_dotenv  # Load environment variables from .env file load_dotenv()  # Retrieve environment variables client_id = os.getenv('LOOKER_CLIENT_ID') client_secret = os.getenv('LOOKER_CLIENT_SECRET') looker_instance = os.getenv('LOOKER_INSTANCE')  # Directories output_directory = '/path/to/looker_objects' os.makedirs(output_directory, exist_ok=True)  # Function to get the authentication token def get_access_token():     url = f'{looker_instance}/api/4.0/login'     headers = {         'Content-Type': 'application/x-www-form-urlencoded'     }     data = {         'client_id': client_id,         'client_secret': client_secret     }     response = requests.post(url, data=data, headers=headers)     response.raise_for_status()     return response.json()['access_token']  # Function to fetch data from API and save it to a file def fetch_and_save_data(endpoint, token, params=None):     url = f'{looker_instance}/api/4.0{endpoint}'     headers = {'Authorization': f'token {token}'}      try:         response = requests.get(url, headers=headers, params=params)         response.raise_for_status()                  data = response.json()         file_name = os.path.join(output_directory, f'{endpoint.strip(\"/\").replace(\"/\", \"_\")}.json')                  with open(file_name, 'w') as f:             json.dump(data, f, indent=4)                  return data  # Return the data for parameter extraction      except requests.exceptions.HTTPError as err:         # Output only the error messages         print(f\"Error: HTTP error occurred for {url}: {err}\")         return None     except Exception as err:         print(f\"Error: An unexpected error occurred for {url}: {err}\")         return None  # Main function def main():     token = get_access_token()          # Step 1: Retrieve All Project IDs     projects_data = fetch_and_save_data('/projects', token)          # Loop through each project to perform further operations     if projects_data:         for project in projects_data:             project_id = project['id']             git_service_name = project.get('git_service_name')                          # Fetch Project-Specific Data             fetch_and_save_data(f'/projects/{project_id}/manifest', token)                          # Skip Git-related operations if the project is a Looker app or plugin             if git_service_name:                 fetch_and_save_data(f'/projects/{project_id}/credentials', token)                 fetch_and_save_data(f'/projects/{project_id}/git_branches', token)                 fetch_and_save_data(f'/projects/{project_id}/active_git_branch', token)                          # Skip LookML-related endpoints if not configured             if project.get('has_lookml_models', False):                 fetch_and_save_data(f'/projects/{project_id}/lookml_models', token)                          # Fetch Folder-Specific Data             folders_data = fetch_and_save_data('/folders', token)             if folders_data:                 for folder in folders_data:                     folder_id = folder['id']                     fetch_and_save_data(f'/folders/{folder_id}/looks', token)                     fetch_and_save_data(f'/folders/{folder_id}/dashboards', token)                                          # Fetch Dashboards within the Folder                     dashboards_data = fetch_and_save_data(f'/folders/{folder_id}/dashboards', token)                     if dashboards_data:                         for dashboard in dashboards_data:                             dashboard_id = dashboard['id']                             fetch_and_save_data(f'/dashboards/{dashboard_id}', token)  if __name__ == '__main__':     main()" }
headers = {
    "accept": "application/json",
    "content-type": "application/json",
    "authorization": "Bearer $ERASERIO_API_KEY"
}
response = requests.post(url, json=payload, headers=headers)

print(response.text)
```

### which will return:

```
{
  "imageUrl": "https://storage.googleapis.com/second-petal-295822.appspot.com/elements/autoDiagram%3A88062bc4b9441bfdc6f1dd5b08b0ebbfab7f7b04e7f95420034b9705909ddc90.png",
  "createEraserFileUrl": "https://app.eraser.io/new?autoDiagramId=ZLGEpZ176srAK0dqRa5u",
  "diagrams": [
    {
      "diagramType": "flowchart-diagram",
      "code": "// Title of the flowchart\ntitle Looker API Data Fetching Process\n\n// Authentication Process\nAuthentication [shape: oval, icon: key] > Load Environment Variables [icon: file-text]\nLoad Environment Variables > Retrieve Credentials [icon: user-check]\nRetrieve Credentials > Get Access Token [icon: lock]\n\n// Fetching Data Process\nGet Access Token > Fetch Project Data [icon: database]\nFetch Project Data > Check Project Data [shape: diamond, icon: check-square]\nCheck Project Data > Fetch Project-Specific Data [icon: folder]: Yes\nCheck Project Data > End Process [shape: oval, icon: x-square]: No\n\n// Project-Specific Data Fetching\nFetch Project-Specific Data > Fetch Project Manifest [icon: file]\nFetch Project Manifest > Check Git Service [shape: diamond, icon: git-branch]\nCheck Git Service > Fetch Git Credentials [icon: key]: Yes\nCheck Git Service > Skip Git Operations [icon: skip-forward]: No\nFetch Git Credentials > Fetch Git Branches [icon: git-branch]\nFetch Git Branches > Fetch Active Git Branch [icon: git-commit]\nFetch Active Git Branch > Check LookML Models [shape: diamond, icon: code]\nCheck LookML Models > Fetch LookML Models [icon: code]: Yes\nCheck LookML Models > Skip LookML Operations [icon: skip-forward]: No\n\n// Folder-Specific Data Fetching\nFetch Project-Specific Data > Fetch Folder Data [icon: folder]\nFetch Folder Data > Check Folder Data [shape: diamond, icon: check-square]\nCheck Folder Data > Fetch Looks [icon: eye]: Yes\nCheck Folder Data > End Process: No\nFetch Looks > Fetch Dashboards [icon: layout]\nFetch Dashboards > Check Dashboards [shape: diamond, icon: check-square]\nCheck Dashboards > Fetch Dashboard Details [icon: layout]: Yes\nCheck Dashboards > End Process: No\n\n// End of Process\nFetch Dashboard Details > End Process\n"
    }
  ]
}
```